{"version":3,"sources":["src/backup-index.js"],"names":["backupIndex","$templateRow","$","$dummy","$uploadButton","$progressBar","$progressBarLabel","find","$statusToggle","$body","resumable","initialize","checkStatusToggle","window","addEventListener","hide","on","e","preventDefault","id","target","closest","attr","BackupApi","BackupDownloadFile","cbAfterDownloadFile","BackupDeleteFile","cbAfterDeleteFile","PbxApi","SystemUploadFileAttachToBtn","cbResumable","checkbox","removeClass","BackupGetFilesList","cbBackupGetFilesListAfterResponse","addClass","response","location","UserMessage","showError","globalTranslate","bkp_ErrorOnDownloadBackup","globalRootUrl","show","length","setTimeout","each","key","value","$newRow","remove","clone","arhDate","Date","date","month","getMonth","day","getDate","html","getFullYear","toLocaleTimeString","size","pid","pid_recover","index","obj","percentOfTotal","progress","total","parseInt","appendTo","idTable","DataTable","paging","searching","columns","orderable","type","action","params","isXML","file","undefined","checkStatusFileMerging","text","bkp_UploadInProgress","percent","bkp_UploadError","message","tryParseJSON","json","JSON","parse","data","fileID","upload_id","filePath","filename","mergingCheckWorker","document","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 12 2019\n *\n */\n\n/* global BackupApi, PbxApi, globalTranslate, Resumable, globalRootUrl, UserMessage, mergingCheckWorker */\n\nconst backupIndex = {\n\t$templateRow: $('#backup-template-row'),\n\t$dummy: $('#dummy-row'),\n\t$uploadButton: $('#uploadbtn'),\n\t$progressBar: $('#upload-progress-bar'),\n\t$progressBarLabel: $('#upload-progress-bar').find('.label'),\n\t$statusToggle: $('#module-status-toggle'),\n\t$body: $('body'),\n\tresumable: null,\n\tinitialize() {\n\t\tbackupIndex.checkStatusToggle();\n\t\twindow.addEventListener('ModuleStatusChanged', backupIndex.checkStatusToggle);\n\t\tbackupIndex.$progressBar.hide();\n\t\tbackupIndex.$body.on('click', 'a.download', (e) => {\n\t\t\te.preventDefault();\n\t\t\tconst id = $(e.target).closest('a').attr('data-value');\n\t\t\tBackupApi.BackupDownloadFile(id,backupIndex.cbAfterDownloadFile);\n\t\t\t//window.location = `${BackupApi.backupDownloadFile}?id=${fileId}`;\n\t\t});\n\t\tbackupIndex.$body.on('click', 'a.delete', (e) => {\n\t\t\te.preventDefault();\n\t\t\tconst id = $(e.target).closest('a').attr('data-value');\n\t\t\tBackupApi.BackupDeleteFile(id, backupIndex.cbAfterDeleteFile);\n\t\t});\n\t\tPbxApi.SystemUploadFileAttachToBtn('uploadbtn',['img', 'zip', 'xml', 'csv', 'tar'], backupIndex.cbResumable);\n\t},\n\t/**\n\t * Изменение статуса кнопок при изменении статуса модуля\n\t */\n\tcheckStatusToggle() {\n\t\tif (backupIndex.$statusToggle.checkbox('is checked')) {\n\t\t\t$('.disability').removeClass('disabled');\n\t\t\tBackupApi.BackupGetFilesList(backupIndex.cbBackupGetFilesListAfterResponse);\n\t\t} else {\n\t\t\t$('.disability').addClass('disabled');\n\t\t}\n\t},\n\t/**\n\t * Коллбек перед скачиванием файла архива\n\t */\n\tcbAfterDownloadFile(response){\n\t\tif (response) {\n\t\t\twindow.location = response;\n\t\t} else {\n\t\t\tUserMessage.showError(globalTranslate.bkp_ErrorOnDownloadBackup)\n\t\t}\n\t},\n\t/**\n\t * Коллбек после удаления файла бекапа\n\t * @param response\n\t */\n\tcbAfterDeleteFile(response) {\n\t\tif (response) {\n\t\t\twindow.location = `${globalRootUrl}module-backup/index`;\n\t\t}\n\t},\n\t/**\n\t * Обработка ответа BackupGetFilesList\n\t * @param response\n\t */\n\tcbBackupGetFilesListAfterResponse(response) {\n\t\tbackupIndex.$dummy.show();\n\t\tif (response.length === 0 || response === false) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tBackupApi.BackupGetFilesList(backupIndex.cbBackupGetFilesListAfterResponse);\n\t\t\t}, 3000);\n\t\t\treturn;\n\t\t}\n\t\tbackupIndex.$dummy.hide();\n\t\t$.each(response, (key, value) => {\n\t\t\tlet $newRow = $(`tr#${value.id}`);\n\t\t\tif ($newRow.length > 0) {\n\t\t\t\t$newRow.remove();\n\t\t\t}\n\t\t\t$newRow = backupIndex.$templateRow.clone();\n\t\t\t$newRow.attr('id', value.id);\n\t\t\t$newRow.addClass('backupIndex-file');\n\t\t\tconst arhDate = new Date(1000 * value.date);\n\t\t\tlet month = ''+(arhDate.getMonth()+1);\n\t\t\tlet day   = ''+arhDate.getDate();\n\t\t\tif(month.length === 1){\n\t\t\t\tmonth = '0' + month;\n\t\t\t}\n\t\t\tif(day.length === 1){\n\t\t\t\tday = '0' + day;\n\t\t\t}\n\t\t\t$newRow.find('.create-date').html(arhDate.getFullYear() + '.' + (month) + '.' + day + ' ' + arhDate.toLocaleTimeString());\n\t\t\t$newRow.find('.create-date').attr('data-order', value.date);\n\t\t\t$newRow.find('.create-date').attr('data-sort', value.date);\n\n\t\t\t$newRow.find('.file-size').html(`${value.size} MB`);\n\t\t\tif (value.pid.length + value.pid_recover.length > 0) {\n\t\t\t\t$newRow.find('a').each((index, obj) => {\n\t\t\t\t\t$(obj).remove();\n\t\t\t\t});\n\t\t\t\tconst percentOfTotal = 100 * (value.progress / value.total);\n\t\t\t\t$newRow.find('.status').html(`<i class=\"spinner loading icon\"></i> ${parseInt(percentOfTotal, 10)} %`);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tBackupApi.BackupGetFilesList(backupIndex.cbBackupGetFilesListAfterResponse);\n\t\t\t\t}, 3000);\n\t\t\t} else {\n\t\t\t\t$newRow.find('a').each((index, obj) => {\n\t\t\t\t\t$(obj).attr('href', $(obj).attr('href') + value.id);\n\t\t\t\t\t$(obj).attr('data-value', value.id);\n\t\t\t\t});\n\t\t\t\t$newRow.find('.status').html('<i class=\"archive icon\"></i>');\n\t\t\t}\n\t\t\t$newRow.appendTo('#existing-backup-files-table');\n\t\t});\n\n\t\tlet idTable = $('#existing-backup-files-table');\n\t\tif(idTable.attr('data-dt-init') !== '1'){\n\t\t\tidTable.DataTable({\n\t\t\t\t'order': [[ 1, 'dsc' ]],\n\t\t\t\tpaging: false,\n\t\t\t\tsearching: false,\n\t\t\t\tcolumns: [\n\t\t\t\t\t{ orderable: false},\n\t\t\t\t\t{ type: 'date'},\n\t\t\t\t\tnull,\n\t\t\t\t\t{ orderable: false },\n\t\t\t\t]\n\t\t\t});\n\t\t\tidTable.attr('data-dt-init', '1');\n\t\t}\n\t},\n/**\n\t * Callback file upload with chunks\n\t * @param action\n\t * @param params\n\t */\n\tcbResumable(action, params){\n\t\tswitch (action) {\n\t\t\tcase 'fileSuccess':\n\t\t\t\tlet isXML = false;\n\t\t\t\tif (params.file.file !== undefined && params.file.file.type !== undefined) {\n\t\t\t\t\tisXML = params.file.file.type === 'text/xml';\n\t\t\t\t}\n\t\t\t\tbackupIndex.checkStatusFileMerging(params.response, isXML);\n\t\t\t\tbackupIndex.$uploadButton.removeClass('loading');\n\t\t\t\tbreak;\n\t\t\tcase 'uploadStart':\n\t\t\t\tbackupIndex.$uploadButton.addClass('loading');\n\t\t\t\tbackupIndex.$progressBar.show();\n\t\t\t\tbackupIndex.$progressBarLabel.text(globalTranslate.bkp_UploadInProgress);\n\t\t\t\tbreak;\n\t\t\tcase 'progress':\n\t\t\t\tbackupIndex.$progressBar.progress({\n\t\t\t\t\tpercent: params.percent,\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'error':\n\t\t\t\tbackupIndex.$progressBarLabel.text(globalTranslate.bkp_UploadError);\n\t\t\t\tbackupIndex.$uploadButton.removeClass('loading');\n\t\t\t\tUserMessage.showError(`${globalTranslate.bkp_UploadError}<br>${params.message}`);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\n\n\t\t}\n\t},\n\t/**\n\t * Запуск процесса ожидания склеивания файла после загрузки на сервер\n\t *\n\t * @param response ответ функции /pbxcore/api/upload/status\n\t */\n\tcheckStatusFileMerging(response, isXML) {\n\t\tif (response === undefined || BackupApi.tryParseJSON(response) === false) {\n\t\t\tUserMessage.showError(`${globalTranslate.bkp_UploadError}`);\n\t\t\treturn;\n\t\t}\n\t\tconst json = JSON.parse(response);\n\t\tif (json === undefined || json.data === undefined) {\n\t\t\tUserMessage.showError(`${globalTranslate.bkp_UploadError}`);\n\t\t\treturn;\n\t\t}\n\t\tconst fileID = json.data.upload_id;\n\t\tconst filePath = json.data.filename;\n\t\tmergingCheckWorker.initialize(fileID, filePath, isXML);\n\t},\n\n};\n\n\n$(document).ready(() => {\n\tbackupIndex.initialize();\n});\n"],"file":"backup-index.js"}